; Author: Guillem Alminyana
;
; A silly example on how to implement the execve for /bin/sh using Relative Addressing.
;
; Uses Rel Addressing to access to all the values required to setup the syscall
;


global _start

section .text

_start:

	jmp real_start

	command: db  "/bin//ls"
	nulo: db 0x00
	addr_command: dq 0x00

real_start:
	
	; RDI <- @command
	lea rdi, [rel command]

	; RSI <- @ ADDR command
	mov rax, [rdi]
	mov [addr_command], rax

	lea rsi, [rel addr_command]

	; RDX <- nulo
	lea rdx, [rel nulo]

  ; Syscall Number
	push 59
  pop rax
	syscall



